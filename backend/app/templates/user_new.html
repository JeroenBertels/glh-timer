{% extends "base.html" %}
{% block content %}
<h1 class="h3 mb-3">Create organizer account</h1>

<div class="card shadow-sm" style="max-width: 600px;">
  <div class="card-body">
    {% if error %}
      <div class="alert alert-danger">{{ error }}</div>
    {% endif %}
    <form method="post" action="/admin/users/new">
      <div class="mb-3">
        <label class="form-label">Username</label>
        <input class="form-control" name="username" autocomplete="username" required>
      </div>
      <div class="mb-3">
        <label class="form-label">Temporary password</label>
        <input class="form-control" name="password" type="password" autocomplete="new-password" required>
        <div class="form-text">You can rotate this later (we can add that feature).</div>
      </div>
      <div class="mb-3">
        <label class="form-label">Race</label>

        {% if preselected_race_id %}
          <input type="hidden" name="race_id" value="{{ preselected_race_id }}">
          <div class="form-text" style="margin-top: -4px;">
            This organizer will be linked to: <strong>{{ preselected_race_id }}</strong>
          </div>
        {% else %}
          <select class="form-select" name="race_id" required>
            {% for r in races %}
              <option value="{{ r.race_id }}">{{ r.race_id }} ({{ r.race_date }})</option>
            {% endfor %}
          </select>
        {% endif %}
      </div>
      <button class="btn btn-primary" type="submit">Create</button>
      {% if preselected_race_id %}
        <a class="btn btn-link" href="/races/{{ preselected_race_id|urlencode }}">Back</a>
      {% else %}
        <a class="btn btn-link" href="/admin/users">Back</a>
      {% endif %}
    </form>
  </div>
</div>
{% endblock %}
